openapi: 3.0.0
info:
  title: Madadyar API Documentation
  description: API documentation for madadyar project. All responses return HTTP 200 status code. Check the `code` field in JSON response to determine success (200) or failure (error codes).
  version: 1.0.0
  contact:
    name: API Support

servers:
  - url: http://dev.karmaniacloud.ir/api/v1
    description: API Server

components:
  securitySchemes:
    bearer:
      type: http
      scheme: bearer
      bearerFormat: Token
      description: "Laravel Sanctum Bearer Token authentication. Send token in Authorization header. Example: 'Bearer {token}'. Token is obtained from /auth/verify-login or /auth/verify-register endpoints."

  schemas:
    BaseResponse:
      type: object
      required:
        - status
        - code
        - message
        - data
      properties:
        status:
          type: boolean
          description: Indicates if the request was successful (true) or failed (false). HTTP status is always 200.
          example: true
        code:
          type: integer
          description: Response code. 200 = success, other codes indicate specific error types. HTTP status is always 200.
          example: 200
        message:
          type: string
          description: Human-readable message describing the result
          example: Operation completed successfully
        data:
          type: object
          description: Response data (structure varies by endpoint)
          nullable: true

    ErrorResponse:
      allOf:
        - $ref: '#/components/schemas/BaseResponse'
        - type: object
          properties:
            status:
              type: boolean
              example: false
            code:
              type: integer
              description: Error code (not 200)
              example: 500
            message:
              type: string
              example: An error occurred

    User:
      type: object
      properties:
        id:
          type: integer
        username:
          type: string
        phone_number:
          type: string
        is_active:
          type: boolean
        created_at:
          type: string
          format: date-time
        updated_at:
          type: string
          format: date-time

    Book:
      type: object
      properties:
        id:
          type: integer
          example: 1
        name:
          type: string
          description: Book name/title
          example: "رمان هری پاتر و سنگ جادو"
        description:
          type: string
          description: Book description (may contain HTML)
          example: "<p>Book description with HTML formatting...</p>"
        file:
          type: string
          description: Path to book file (PDF)
          example: "/storage/files/J.K. Rowling - H.P00-Prequel.pdf"
        book_category_id:
          type: integer
          description: Foreign key to book category
          example: 1
        image:
          type: string
          description: Path to book cover image
          example: "/storage/photos/9781408855652.jpg"
        price:
          type: number
          description: Book price
          example: 544000
        deleted_at:
          type: string
          format: date-time
          nullable: true
          description: Soft delete timestamp (null if not deleted)
        created_at:
          type: string
          format: date-time
          description: Creation timestamp
          example: "2025-11-04T23:15:43.000000Z"
        updated_at:
          type: string
          format: date-time
          description: Last update timestamp
          example: "2025-11-04T23:15:43.000000Z"
        category:
          $ref: '#/components/schemas/Category'
          description: Book category object (loaded via relationship)

    Video:
      type: object
      properties:
        id:
          type: integer
          example: 1
        name:
          type: string
          description: Video name/title
          example: "ویدیو آموزشی"
        description:
          type: string
          description: Video description (may contain HTML)
          nullable: true
        video_category_id:
          type: integer
          description: Foreign key to video category
          nullable: true
        file:
          type: string
          nullable: true
          description: Path to video file
        image:
          type: string
          nullable: true
          description: Path to video thumbnail image
        deleted_at:
          type: string
          format: date-time
          nullable: true
          description: Soft delete timestamp (null if not deleted)
        created_at:
          type: string
          format: date-time
          description: Creation timestamp
        updated_at:
          type: string
          format: date-time
          description: Last update timestamp
        category:
          $ref: '#/components/schemas/Category'
          description: Video category object (loaded via relationship)
          nullable: true

    Category:
      type: object
      properties:
        id:
          type: integer
          example: 1
        parent_id:
          type: integer
          nullable: true
          description: Parent category ID (null for main categories)
          example: null
        name:
          type: string
          description: Category name
          example: "رمان علمی تخیلی"
        image:
          type: string
          nullable: true
          description: Path to category image
          example: "/storage/photos/9781408855713.jpg"

    Cart:
      type: object
      properties:
        id:
          type: integer
        items:
          type: array
          items:
            type: object
        price:
          type: number
        close:
          type: boolean

    PaymentLink:
      type: object
      properties:
        link:
          type: string
          description: Payment gateway URL
        trans_id:
          type: string

    PaginationMeta:
      type: object
      properties:
        current_page:
          type: integer
          example: 1
          description: Current page number
        from:
          type: integer
          example: 1
          description: First item number on current page
        last_page:
          type: integer
          example: 10
          description: Last page number
        per_page:
          type: integer
          example: 15
          description: Number of items per page
        to:
          type: integer
          example: 15
          description: Last item number on current page
        total:
          type: integer
          example: 150
          description: Total number of items
        first_page_url:
          type: string
          description: URL to first page
        last_page_url:
          type: string
          description: URL to last page
        next_page_url:
          type: string
          nullable: true
          description: URL to next page (null if on last page)
        prev_page_url:
          type: string
          nullable: true
          description: URL to previous page (null if on first page)
        path:
          type: string
          description: Base path for pagination URLs
        links:
          type: array
          description: Array of pagination links
          items:
            type: object
            properties:
              url:
                type: string
                nullable: true
                description: URL for this page (null for Previous/Next labels)
              label:
                type: string
                description: Label for the link (e.g., "1", "2", "&laquo; قبلی", "بعدی &raquo;")
                active:

    PaginatedBooks:
      allOf:
        - $ref: '#/components/schemas/PaginationMeta'
        - type: object
          required:
            - data
          properties:
            data:
              type: array
              description: Array of book items
              items:
                $ref: '#/components/schemas/Book'

    PaginatedVideos:
      allOf:
        - $ref: '#/components/schemas/PaginationMeta'
        - type: object
          required:
            - data
          properties:
            data:
              type: array
              description: Array of video items
              items:
                $ref: '#/components/schemas/Video'

paths:
  # ==================== AUTHENTICATION ENDPOINTS ====================
  /auth/login:
    post:
      operationId: auth.login
      summary: Login with phone number
      description: |
        Send phone number to receive verification code. The code will be sent via SMS.
        After receiving the code, use `/verify-login` endpoint to complete login.
      tags:
        - Authentication
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - phone_number
              properties:
                phone_number:
                  type: string
                  pattern: '^\d{11}$'
                  description: Phone number (11 digits)
                  example: "09368373672"
      responses:
        '200':
          description: Response always returns HTTP 200. Check `code` field for result.
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/BaseResponse'
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          user:
                            $ref: '#/components/schemas/User'
                          code:
                            type: integer
                            description: Verification code (for testing only, should not be returned in production)
                            example: 1234
              examples:
                success:
                  value:
                    status: true
                    code: 200
                    message: "کد تایید با موفقیت ارسال شد."
                    data:
                      user:
                        id: 1
                        phone_number: "09368373672"
                      code: 1234
                error:
                  value:
                    status: false
                    code: 704
                    message: "کاربر یافت نشد."
                    data: null

  /auth/verify-login:
    post:
      operationId: auth.verifyLogin
      summary: Verify login code
      description: |
        Verify the code received via SMS and complete login process.
        Returns authentication token on success.
      tags:
        - Authentication
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - phone_number
                - verification_code
              properties:
                phone_number:
                  type: string
                  pattern: '^\d{11}$'
                  description: Phone number (11 digits)
                  example: "09368373672"
                verification_code:
                  type: string
                  pattern: '^\d{4}$'
                  description: 4-digit verification code
                  example: "1234"
      responses:
        '200':
          description: Response always returns HTTP 200. Check `code` field for result.
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/BaseResponse'
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          user:
                            $ref: '#/components/schemas/User'
                          token:
                            type: string
                            description: JWT authentication token
              examples:
                success:
                  value:
                    status: true
                    code: 200
                    message: "ورود با موفقیت انجام شد."
                    data:
                      user:
                        id: 1
                        phone_number: "09368373672"
                      token: "eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9..."
                error:
                  value:
                    status: false
                    code: 702
                    message: "کد تایید صحیح نیست."
                    data: null

  /auth/register:
    post:
      operationId: auth.register
      summary: Register new user
      description: |
        Register a new user with username and phone number.
        A verification code will be sent via SMS.
      tags:
        - Authentication
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - username
                - phone_number
              properties:
                username:
                  type: string
                  minLength: 1
                  maxLength: 255
                  description: Username for the user
                  example: "amirreza.mirataollahi"
                phone_number:
                  type: string
                  pattern: '^\d{11}$'
                  description: Phone number (11 digits)
                  example: "09368373672"
      responses:
        '200':
          description: Response always returns HTTP 200. Check `code` field for result.
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/BaseResponse'
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          user:
                            $ref: '#/components/schemas/User'
                          code:
                            type: integer
                            description: Verification code (for testing only)
              examples:
                success:
                  value:
                    status: true
                    code: 200
                    message: "کد تایید با موفقیت ارسال شد."
                    data:
                      user:
                        id: 1
                        username: "John Doe"
                        phone_number: "09368373672"
                      code: 1234
                error:
                  value:
                    status: false
                    code: 422
                    message: "خطا در اعتبارسنجی."
                    data: null

  /auth/verify-register:
    post:
      operationId: auth.verifyRegister
      summary: Verify registration code
      description: |
        Verify the registration code and activate user account.
        Returns authentication token on success.
      tags:
        - Authentication
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - phone_number
                - verification_code
              properties:
                phone_number:
                  type: string
                  pattern: '^\d{11}$'
                  description: Phone number (11 digits)
                  example: "09368373672"
                verification_code:
                  type: string
                  pattern: '^\d{4}$'
                  description: 4-digit verification code
                  example: "1234"
      responses:
        '200':
          description: Response always returns HTTP 200. Check `code` field for result.
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/BaseResponse'
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          user:
                            $ref: '#/components/schemas/User'
                          token:
                            type: string
                            description: JWT authentication token
              examples:
                success:
                  value:
                    status: true
                    code: 200
                    message: "ثبت نام با موفقیت انجام شد."
                    data:
                      user:
                        id: 1
                        phone_number: "09368373672"
                      token: "eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9..."
                error:
                  value:
                    status: false
                    code: 702
                    message: "کد تایید صحیح نیست."
                    data: null

  # ==================== BOOKS ENDPOINTS ====================
  /books:
    get:
      operationId: books.index
      summary: Get all books
      description: Retrieve a paginated list of all books. Pagination metadata is automatically included in the response.
      tags:
        - Books
      security:
        - bearer: []
      parameters:
        - name: page
          in: query
          schema:
            type: integer
            default: 1
          description: Page number
      responses:
        '200':
          description: Response always returns HTTP 200. Check `code` field for result.
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/BaseResponse'
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          books:
                            $ref: '#/components/schemas/PaginatedBooks'
              examples:
                success:
                  value:
                    status: true
                    code: 200
                    message: "با موفقیت انجام شد"
                    data:
                      books:
                        current_page: 1
                        data:
                          - id: 1
                            name: "رمان هری پاتر و سنگ جادو"
                            description: "<p><span style=\"margin: 0px auto; padding: 0px; max-width: 100%; font-family: arial, helvetica, sans-serif; font-size: medium;\">هری پاتر&nbsp;نام مجموعه‌ای هفت‌گانه از</span><span style=\"margin: 0px auto; padding: 0px; max-width: 100%; font-family: inherit; font-size: medium;\"><span style=\"margin: 0px auto; padding: 0px; max-width: 100%; font-family: arial, helvetica, sans-serif; font-size: inherit;\">&nbsp;</span><span style=\"margin: 0px auto; padding: 0px; max-width: 100%; font-family: arial, helvetica, sans-serif; font-size: inherit;\">رمان های</span></span><span style=\"margin: 0px auto; padding: 0px; max-width: 100%; font-family: inherit; font-size: medium;\"><span style=\"margin: 0px auto; padding: 0px; max-width: 100%; font-family: arial, helvetica, sans-serif; font-size: inherit;\">&nbsp;سبک خیا</span></span><span style=\"margin: 0px auto; padding: 0px; max-width: 100%; font-family: inherit; font-size: medium;\"><span style=\"margin: 0px auto; padding: 0px; max-width: 100%; font-family: arial, helvetica, sans-serif; font-size: inherit;\">ل پردازی</span></span><span style=\"margin: 0px auto; padding: 0px; max-width: 100%; font-family: inherit; font-size: medium;\"><span style=\"margin: 0px auto; padding: 0px; max-width: 100%; font-family: arial, helvetica, sans-serif; font-size: inherit;\">&nbsp;است که توسط نویسنده انگلیسی،جوآن کتلین رولینگ</span></span><span style=\"margin: 0px auto; padding: 0px; max-width: 100%; font-family: inherit; font-size: medium;\"><span style=\"margin: 0px auto; padding: 0px; max-width: 100%; font-family: arial, helvetica, sans-serif; font-size: inherit;\">&nbsp;نوشته شده‌است.&nbsp;</span></span><span style=\"margin: 0px auto; padding: 0px; max-width: 100%; font-family: inherit; font-size: medium;\"><span style=\"margin: 0px auto; padding: 0px; max-width: 100%; font-family: arial, helvetica, sans-serif; font-size: inherit;\">&nbsp;از آنجا که اولین رمان در تاریخ ۳۰ ژوئن ۱۹۹۷ با عنوان هری پاتر و سنگ جادو منتشر شد، کتاب محبوبیت بسیار زیاد، تحسین فراوان و موفقیت تجاری را در جهان کسب کرد.تا ژوئن ۲۰۱۱، کتاب ها درحدود ۴۵۰میلیون نسخه فروش داشته و به ۶۷ زبان دنیا ترجمه شده است. و چهار کتاب پایانی این مجموعه به طور متوالی رکورد فروش سریعترین کتاب های جهان را دارد.هری پاتر یک مجموعه با چندین ژانر، ازجمله فانتزی، گذرعمر(با عناصری از رمزآلود، هیجان انگیز، ماجراجویی، و عاشقانه )، که دارای بسیاری از معانی فرهنگی و این ارجاعات می باشد.با این حال براساس گفته رولینگ، موضوع اصلی داستان مرگ است.داستان پیرامون کودک یتیم یازده ساله ای به نام هری پاتر که یک جادوگر است می باشد</span></span></p>"
                            file: "/storage/files/J.K. Rowling - H.P00-Prequel.pdf"
                            book_category_id: 1
                            image: "/storage/photos/9781408855652.jpg"
                            price: 544000
                            deleted_at: null
                            created_at: "2025-11-04T23:15:43.000000Z"
                            updated_at: "2025-11-04T23:15:43.000000Z"
                            category:
                              id: 1
                              parent_id: null
                              name: "رمان علمی تخیلی"
                              image: "/storage/photos/9781408855713.jpg"
                        first_page_url: "http://192.168.88.66:8000/api/v1/books?page=1"
                        from: 1
                        last_page: 1
                        last_page_url: "http://192.168.88.66:8000/api/v1/books?page=1"
                        links:
                          - url: null
                            label: "&laquo; قبلی"
                            active: false
                          - url: "http://192.168.88.66:8000/api/v1/books?page=1"
                            label: "1"
                            active: true
                          - url: null
                            label: "بعدی &raquo;"
                            active: false
                        next_page_url: null
                        path: "http://192.168.88.66:8000/api/v1/books"
                        per_page: 7
                        prev_page_url: null
                        to: 1
                        total: 1

    # Note: POST, PUT, DELETE are not implemented in controller

  /books/{id}:
    get:
      operationId: books.show
      summary: Get book by ID
      description: Retrieve detailed information about a specific book
      tags:
        - Books
      security:
        - bearer: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
          description: Book ID
      responses:
        '200':
          description: Response always returns HTTP 200. Check `code` field for result.
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/BaseResponse'
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          book:
                            $ref: '#/components/schemas/Book'
              examples:
                success:
                  value:
                    status: true
                    code: 200
                    message: "با موفقیت انجام شد"
                    data:
                      book:
                        id: 1
                        name: "رمان هری پاتر و سنگ جادو"
                        description: "<p>توضیحات کتاب...</p>"
                        file: "/storage/files/J.K. Rowling - H.P00-Prequel.pdf"
                        book_category_id: 1
                        image: "/storage/photos/9781408855652.jpg"
                        price: 544000
                        deleted_at: null
                        created_at: "2025-11-04T23:15:43.000000Z"
                        updated_at: "2025-11-04T23:15:43.000000Z"
                        category:
                          id: 1
                          parent_id: null
                          name: "رمان علمی تخیلی"
                          image: "/storage/photos/9781408855713.jpg"
                error:
                  value:
                    status: false
                    code: 405
                    message: "کتاب یافت نشد."
                    data: null

  /books/search/{q}:
    get:
      operationId: books.search
      summary: Search books
      description: Search books by query string
      tags:
        - Books
      security:
        - bearer: []
      parameters:
        - name: q
          in: path
          required: true
          schema:
            type: string
          description: Search query
          example: "programming"
      responses:
        '200':
          description: Response always returns HTTP 200. Check `code` field for result.
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/BaseResponse'
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          data:
                            type: array
                            items:
                              $ref: '#/components/schemas/Book'
                          totalPage:
                            type: integer
              examples:
                success:
                  value:
                    status: true
                    code: 200
                    message: "نتایج جستجو با موفقیت دریافت شد."
                    data:
                      data: []
                      totalPage: 1

  /books/get-by-cat-id/{catId}:
    get:
      operationId: books.getByCategory
      summary: Get books by category ID
      description: Retrieve all books in a specific category
      tags:
        - Books
      security:
        - bearer: []
      parameters:
        - name: catId
          in: path
          required: true
          schema:
            type: integer
          description: Category ID
      responses:
        '200':
          description: Response always returns HTTP 200. Check `code` field for result.
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/BaseResponse'
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          data:
                            type: array
                            items:
                              $ref: '#/components/schemas/Book'
                          totalPage:
                            type: integer

  /book/purchased_book:
    post:
      operationId: books.purchasedBook
      summary: Get purchased books or check purchase status
      description: |
        If `book_id` is provided, returns whether the book is purchased.
        If `book_id` is not provided, returns all purchased books.
      tags:
        - Books
      security:
        - bearer: []
      requestBody:
        required: false
        content:
          application/json:
            schema:
              type: object
              properties:
                book_id:
                  type: integer
                  description: Optional book ID to check purchase status
      responses:
        '200':
          description: Response always returns HTTP 200. Check `code` field for result.
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/BaseResponse'
                  - type: object
                    properties:
                      data:
                        oneOf:
                          - type: object
                            properties:
                              is_purchased:
                                type: boolean
                                description: Whether the book is purchased (when book_id provided)
                          - type: object
                            properties:
                              books:
                                type: array
                                items:
                                  type: object
                                description: List of purchased books (when book_id not provided)
              examples:
                withBookId:
                  value:
                    status: true
                    code: 200
                    message: "اطلاعات با موفقیت دریافت شد."
                    data:
                      is_purchased: true
                withoutBookId:
                  value:
                    status: true
                    code: 200
                    message: "کتاب‌های خریداری شده با موفقیت دریافت شد."
                    data:
                      books: []

  # ==================== VIDEOS ENDPOINTS ====================
  /videos:
    get:
      operationId: videos.index
      summary: Get all videos
      description: Retrieve a paginated list of all videos. Pagination metadata is automatically included in the response.
      tags:
        - Videos
      security:
        - bearer: []
      parameters:
        - name: page
          in: query
          schema:
            type: integer
            default: 1
          description: Page number
      responses:
        '200':
          description: Response always returns HTTP 200. Check `code` field for result.
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/BaseResponse'
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          videos:
                            $ref: '#/components/schemas/PaginatedVideos'
              examples:
                success:
                  value:
                    status: true
                    code: 200
                    message: "با موفقیت انجام شد"
                    data:
                      videos:
                        current_page: 1
                        data:
                          - id: 1
                            name: "ویدیو آموزشی برنامه نویسی"
                            description: "<p>توضیحات ویدیو آموزشی</p>"
                            video_category_id: 1
                            file: "/storage/videos/programming-tutorial.mp4"
                            image: "/storage/photos/video-thumbnail.jpg"
                            deleted_at: null
                            created_at: "2025-11-04T23:15:43.000000Z"
                            updated_at: "2025-11-04T23:15:43.000000Z"
                            category:
                              id: 1
                              parent_id: null
                              name: "آموزشی"
                              image: "/storage/photos/category-image.jpg"
                        first_page_url: "http://192.168.88.66:8000/api/v1/videos?page=1"
                        from: 1
                        last_page: 5
                        last_page_url: "http://192.168.88.66:8000/api/v1/videos?page=5"
                        links:
                          - url: null
                            label: "&laquo; قبلی"
                            active: false
                          - url: "http://192.168.88.66:8000/api/v1/videos?page=1"
                            label: "1"
                            active: true
                          - url: "http://192.168.88.66:8000/api/v1/videos?page=2"
                            label: "2"
                            active: false
                          - url: null
                            label: "بعدی &raquo;"
                            active: false
                        next_page_url: "http://192.168.88.66:8000/api/v1/videos?page=2"
                        path: "http://192.168.88.66:8000/api/v1/videos"
                        per_page: 15
                        prev_page_url: null
                        to: 15
                        total: 75

  /videos/{id}:
    get:
      operationId: videos.show
      summary: Get video by ID
      description: Retrieve detailed information about a specific video
      tags:
        - Videos
      security:
        - bearer: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: integer
          description: Video ID
      responses:
        '200':
          description: Response always returns HTTP 200. Check `code` field for result.
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/BaseResponse'
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          video:
                            $ref: '#/components/schemas/Video'
              examples:
                success:
                  value:
                    status: true
                    code: 200
                    message: "با موفقیت انجام شد"
                    data:
                      video:
                        id: 1
                        name: "ویدیو آموزشی برنامه نویسی"
                        description: "<p>توضیحات ویدیو آموزشی</p>"
                        video_category_id: 1
                        file: "/storage/videos/programming-tutorial.mp4"
                        image: "/storage/photos/video-thumbnail.jpg"
                        deleted_at: null
                        created_at: "2025-11-04T23:15:43.000000Z"
                        updated_at: "2025-11-04T23:15:43.000000Z"
                        category:
                          id: 1
                          parent_id: null
                          name: "آموزشی"
                          image: "/storage/photos/category-image.jpg"
                error:
                  value:
                    status: false
                    code: 405
                    message: "ویدیو یافت نشد."
                    data: null

  /videos/search/{q}:
    get:
      operationId: videos.search
      summary: Search videos
      description: Search videos by query string
      tags:
        - Videos
      security:
        - bearer: []
      parameters:
        - name: q
          in: path
          required: true
          schema:
            type: string
          description: Search query
          example: "tutorial"
      responses:
        '200':
          description: Response always returns HTTP 200. Check `code` field for result.
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/BaseResponse'
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          data:
                            type: array
                            items:
                              $ref: '#/components/schemas/Video'

  /videos/get-by-cat-id/{catId}:
    get:
      operationId: videos.getByCategory
      summary: Get videos by category ID
      description: Retrieve all videos in a specific category
      tags:
        - Videos
      security:
        - bearer: []
      parameters:
        - name: catId
          in: path
          required: true
          schema:
            type: integer
          description: Category ID
      responses:
        '200':
          description: Response always returns HTTP 200. Check `code` field for result.
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/BaseResponse'
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          data:
                            type: array
                            items:
                              $ref: '#/components/schemas/Video'

  # ==================== BOOK CATEGORIES ENDPOINTS ====================
  /book-categories:
    get:
      operationId: bookCategories.index
      summary: Get all book categories
      description: Retrieve a list of all book categories
      tags:
        - Book Categories
      security:
        - bearer: []
      responses:
        '200':
          description: Response always returns HTTP 200. Check `code` field for result.
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/BaseResponse'
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          categories:
                            type: array
                            items:
                              $ref: '#/components/schemas/Category'
              examples:
                success:
                  value:
                    status: true
                    code: 200
                    message: "دسته‌بندی‌ها با موفقیت دریافت شد."
                    data:
                      categories: []

  /book-categories/main-categories:
    get:
      operationId: bookCategories.mainCategories
      summary: Get main book categories
      description: Retrieve only main categories (categories without parent)
      tags:
        - Book Categories
      security:
        - bearer: []
      responses:
        '200':
          description: Response always returns HTTP 200. Check `code` field for result.
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/BaseResponse'
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          categories:
                            type: array
                            items:
                              $ref: '#/components/schemas/Category'

  /book-categories/get-by-cat-id/{catId}:
    get:
      operationId: bookCategories.getByCategoryId
      summary: Get category by ID
      description: Retrieve category information and its subcategories
      tags:
        - Book Categories
      security:
        - bearer: []
      parameters:
        - name: catId
          in: path
          required: true
          schema:
            type: integer
          description: Category ID
      responses:
        '200':
          description: Response always returns HTTP 200. Check `code` field for result.
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/BaseResponse'
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          categories:
                            type: array
                            items:
                              $ref: '#/components/schemas/Category'
              examples:
                error:
                  value:
                    status: false
                    code: 405
                    message: "دسته‌بندی یافت نشد."
                    data: null

  # ==================== VIDEO CATEGORIES ENDPOINTS ====================
  /video-categories:
    get:
      operationId: videoCategories.index
      summary: Get all video categories
      description: Retrieve a list of all video categories
      tags:
        - Video Categories
      security:
        - bearer: []
      responses:
        '200':
          description: Response always returns HTTP 200. Check `code` field for result.
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/BaseResponse'
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          categories:
                            type: array
                            items:
                              $ref: '#/components/schemas/Category'

  /video-categories/main-categories:
    get:
      operationId: videoCategories.mainCategories
      summary: Get main video categories
      description: Retrieve only main categories (categories without parent)
      tags:
        - Video Categories
      security:
        - bearer: []
      responses:
        '200':
          description: Response always returns HTTP 200. Check `code` field for result.
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/BaseResponse'
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          categories:
                            type: array
                            items:
                              $ref: '#/components/schemas/Category'

  /video-categories/get-by-cat-id/{catId}:
    get:
      operationId: videoCategories.getByCategoryId
      summary: Get category by ID
      description: Retrieve category information and its subcategories
      tags:
        - Video Categories
      security:
        - bearer: []
      parameters:
        - name: catId
          in: path
          required: true
          schema:
            type: integer
          description: Category ID
      responses:
        '200':
          description: Response always returns HTTP 200. Check `code` field for result.
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/BaseResponse'
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          categories:
                            type: array
                            items:
                              $ref: '#/components/schemas/Category'
              examples:
                error:
                  value:
                    status: false
                    code: 405
                    message: "دسته‌بندی یافت نشد."
                    data: null

  # ==================== ALL CATEGORIES ENDPOINT ====================
  /all-categories:
    get:
      operationId: categories.allCategories
      summary: Get all categories (books and videos)
      description: Retrieve all categories including both book and video categories
      tags:
        - Categories
      security:
        - bearer: []
      responses:
        '200':
          description: Response always returns HTTP 200. Check `code` field for result.
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/BaseResponse'
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          data:
                            type: array
                            items:
                              type: object
                              description: Category object with type indicator

  # ==================== CART ENDPOINTS ====================
  /cart:
    get:
      operationId: cart.index
      summary: Get user cart
      description: Retrieve the current user's shopping cart
      tags:
        - Cart
      security:
        - bearer: []
      responses:
        '200':
          description: Response always returns HTTP 200. Check `code` field for result.
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/BaseResponse'
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          cart:
                            $ref: '#/components/schemas/Cart'
              examples:
                success:
                  value:
                    status: true
                    code: 200
                    message: "سبد خرید با موفقیت دریافت شد."
                    data:
                      cart:
                        id: 1
                        items: []
                        price: 0

    post:
      operationId: cart.store
      summary: Add or remove item from cart
      description: Add a book to cart or remove it from cart
      tags:
        - Cart
      security:
        - bearer: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - operation
                - book_id
              properties:
                operation:
                  type: string
                  enum: [add, remove]
                  description: Operation to perform
                  example: "add"
                book_id:
                  type: integer
                  description: Book ID to add or remove
                  example: 1
      responses:
        '200':
          description: Response always returns HTTP 200. Check `code` field for result.
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/BaseResponse'
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          cart:
                            $ref: '#/components/schemas/Cart'
              examples:
                success:
                  value:
                    status: true
                    code: 200
                    message: "عملیات با موفقیت انجام شد."
                    data:
                      cart:
                        id: 1
                        items: []
                error:
                  value:
                    status: false
                    code: 405
                    message: "کتاب یافت نشد."
                    data: null

  # ==================== USER ENDPOINT ====================
  /user:
    get:
      operationId: user.info
      summary: Get current user information
      description: Retrieve information about the authenticated user
      tags:
        - User
      security:
        - bearer: []
      responses:
        '200':
          description: Response always returns HTTP 200. Check `code` field for result.
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/BaseResponse'
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          user:
                            $ref: '#/components/schemas/User'
              examples:
                success:
                  value:
                    status: true
                    code: 200
                    message: "اطلاعات کاربر با موفقیت دریافت شد."
                    data:
                      user:
                        id: 1
                        username: "John Doe"
                        phone_number: "09368373672"

  # ==================== PAYMENT ENDPOINT ====================
  /pay:
    get:
      operationId: payment.initiate
      summary: Initiate payment
      description: |
        Create payment link for the current user's cart.
        If cart is empty, returns error.
        If cart is free (all items are free), returns success without payment link.
        Otherwise, creates payment gateway link.
      tags:
        - Payment
      security:
        - bearer: []
      responses:
        '200':
          description: Response always returns HTTP 200. Check `code` field for result.
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/BaseResponse'
                  - type: object
                    properties:
                      data:
                        oneOf:
                          - type: object
                            properties:
                              is_free:
                                type: boolean
                                description: Indicates cart is free
                              cart:
                                $ref: '#/components/schemas/Cart'
                              message:
                                type: string
                            description: Response when cart is free
                          - type: object
                            properties:
                              payment:
                                $ref: '#/components/schemas/PaymentLink'
                            description: Response with payment link
              examples:
                success:
                  value:
                    status: true
                    code: 200
                    message: "لینک پرداخت با موفقیت ایجاد شد."
                    data:
                      payment:
                        link: "https://nextpay.org/nx/gateway/payment/123456"
                        trans_id: "123456"
                freeCart:
                  value:
                    status: true
                    code: 200
                    message: "سبد خرید رایگان است."
                    data:
                      is_free: true
                      cart:
                        id: 1
                        price: 0
                emptyCart:
                  value:
                    status: false
                    code: 422
                    message: "سبد خرید خالی است."
                    data: null
                error:
                  value:
                    status: false
                    code: 500
                    message: "خطا در ایجاد لینک پرداخت."
                    data: null

# ==================== ERROR CODES REFERENCE ====================
# Common error codes used in responses:
# 200  - Success
# 401  - Authorization Error
# 404  - Page Not Found
# 405  - Model Not Found
# 406  - Method Not Found
# 407  - Route Not Found
# 422  - Validation Fail
# 500  - Server Error
# 501  - Database Error
# 701  - Authentication Error
# 702  - Invalid Verification Code
# 703  - User Is Disabled
# 704  - Invalid API Token
# 706  - Too Many Login Attempt
# 707  - Invalid Username Password
# 708  - Post Too Large
# 709  - Guest Error
# 960  - Agent Not Verified
# 961  - Fail SMS Send
# 962  - Too Many OTP Code Request
# 980  - Invalid Mini App Auth
# 982  - Mini App Mobile Validate Failed
# 990  - Failed Profile Update
# 1100 - Auth Login Error

